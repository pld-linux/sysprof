Based on: http://svn.gnome.org/viewvc/sysprof/trunk/module/sysprof-module.c?r1=405&r2=419
--- sysprof-1.0.10/module/sysprof-module.c.orig	2008-04-28 03:07:48.000000000 +0200
+++ sysprof-1.0.10/module/sysprof-module.c	2008-07-06 10:32:39.891659943 +0200
@@ -67,12 +67,7 @@
 DECLARE_WAIT_QUEUE_HEAD (wait_for_exit);
 
 /* Macro the names of the registers that are used on each architecture */
-#if defined(CONFIG_X86_64)
-#       define REG_FRAME_PTR rbp
-#       define REG_INS_PTR rip
-#       define REG_STACK_PTR rsp
-#       define REG_STACK_PTR0 rsp0
-#elif defined(CONFIG_X86)
+#if defined(CONFIG_X86)
 #       if LINUX_VERSION_CODE >= KERNEL_VERSION (2,6,25)
 #               define REG_FRAME_PTR bp
 #               define REG_INS_PTR ip
@@ -84,6 +79,11 @@
 #               define REG_STACK_PTR esp
 #               define REG_STACK_PTR0 esp0
 #       endif
+#elif defined(CONFIG_X86_64) /* pre-2.6.25 separate architecture */
+#      define REG_FRAME_PTR rbp
+#      define REG_INS_PTR rip
+#      define REG_STACK_PTR rsp
+#      define REG_STACK_PTR0 rsp0
 #else
 #       error Sysprof only supports the i386 and x86-64 architectures
 #endif
